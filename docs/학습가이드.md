# ğŸ¯ ì¹´ë‚˜ë¦¬ ë°°í¬ ì‹¤ë¬´ í•™ìŠµ ê°€ì´ë“œ

ì‹¤ë¬´ì—ì„œ ë°”ë¡œ ì ìš©í•  ìˆ˜ ìˆëŠ” ì¹´ë‚˜ë¦¬ ë°°í¬ ì‹œìŠ¤í…œì„ ë‹¨ê³„ë³„ë¡œ í•™ìŠµí•˜ëŠ” ëŒ€í™”í˜• ê°€ì´ë“œì…ë‹ˆë‹¤.

## ğŸ“‹ í•™ìŠµ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

ì‹œì‘í•˜ê¸° ì „ì— ë‹¤ìŒ í•­ëª©ì„ í™•ì¸í•˜ì„¸ìš”:

- âœ… Docker ë° Docker Compose ì„¤ì¹˜ ì™„ë£Œ
- âœ… K6 ì„¤ì¹˜ ì™„ë£Œ (`brew install k6` ë˜ëŠ” [ê³µì‹ ë¬¸ì„œ](https://k6.io/docs/getting-started/installation/) ì°¸ì¡°)
- âœ… Git ì €ì¥ì†Œ í´ë¡  ì™„ë£Œ
- âœ… 8000-9090 í¬íŠ¸ ë²”ìœ„ ì‚¬ìš© ê°€ëŠ¥ í™•ì¸

## ğŸš€ Phase 1: ê¸°ë³¸ ì‹œìŠ¤í…œ ì´í•´ ë° êµ¬ë™

### Step 1.1: ì „ì²´ ì‹œìŠ¤í…œ êµ¬ë™
```bash
# ì „ì²´ ì‹œìŠ¤í…œ ì‹œì‘
docker-compose up -d

# ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
docker-compose ps

# ë¡œê·¸ ëª¨ë‹ˆí„°ë§ (ë³„ë„ í„°ë¯¸ë„)
docker compose logs -f nginx legacy-app-1 refactored-app-1
```

**âœ… ì™„ë£Œ í™•ì¸:**
- âœ… ëª¨ë“  ì»¨í…Œì´ë„ˆê°€ `healthy` ìƒíƒœ
- âœ… NGINX ë¡œë“œë°¸ëŸ°ì„œ ì ‘ê·¼ ê°€ëŠ¥: http://localhost:8000/api/hello
- âœ… Prometheus ì ‘ê·¼ ê°€ëŠ¥: http://localhost:9090
- âœ… Grafana ì ‘ê·¼ ê°€ëŠ¥: http://localhost:3000 (admin/admin)

### Step 1.2: ê¸°ë³¸ íŠ¸ë˜í”½ ë¶„ë°° í™•ì¸
```bash
# ê¸°ë³¸ íŠ¸ë˜í”½ ë¶„ë°° í…ŒìŠ¤íŠ¸
for i in {1..20}; do
  curl -s http://localhost:8000/api/version | jq '.version'
  sleep 1
done
```

**ğŸ” ê´€ì°°í•  ì :**
- âœ… ëŒ€ë¶€ë¶„ ìš”ì²­ì´ "legacy" ë²„ì „ìœ¼ë¡œ ë¼ìš°íŒ… (95%)
- âœ… ì¼ë¶€ ìš”ì²­ì´ "refactored" ë²„ì „ìœ¼ë¡œ ë¼ìš°íŒ… (5%)
- âœ… Response í—¤ë”ì— `X-Upstream-Server` ì •ë³´ í¬í•¨

---

## ğŸ›ï¸ Phase 2: ìˆ˜ë™ íŠ¸ë˜í”½ ì œì–´ í•™ìŠµ

### Step 2.1: íŠ¸ë˜í”½ ê°€ì¤‘ì¹˜ ì¡°íšŒ
```bash
# í˜„ì¬ íŠ¸ë˜í”½ ìƒíƒœ í™•ì¸
curl http://localhost:8000/api/traffic/status | jq .

# ë°°í¬ ìƒíƒœ í™•ì¸
curl http://localhost:8000/api/traffic/canary/status | jq .
```

---

## ğŸ¤– Phase 3: ìë™ ë°°í¬ ì‹œìŠ¤í…œ í•™ìŠµ

### Step 3.1: ìë™ ë°°í¬ ì‹œì‘
```bash
# ìë™ ë°°í¬ ì‹œì‘
curl -X POST http://localhost:8000/api/auto-deployment/start | jq .

# ìƒíƒœ ëª¨ë‹ˆí„°ë§ (ë³„ë„ í„°ë¯¸ë„ì—ì„œ ì‹¤í–‰)
watch -n 5 'curl -s http://localhost:8000/api/auto-deployment/dashboard | jq .'
```

### Step 3.2: SLI/SLO ë©”íŠ¸ë¦­ ì´í•´
```bash
# í˜„ì¬ SLI/SLO ìƒíƒœ í™•ì¸
curl http://localhost:8000/api/auto-deployment/sli-slo | jq .

# SLI/SLO ì„¤ì • ì •ë³´ í™•ì¸
curl http://localhost:8000/api/auto-deployment/sli-slo/config | jq .
```

**ğŸ¯ í•µì‹¬ ë©”íŠ¸ë¦­:**
- [ ] **Error Rate**: ì—ëŸ¬ìœ¨ (ëª©í‘œ: < 2%)
- [ ] **Response Time P95**: 95%ile ì‘ë‹µì‹œê°„ (ëª©í‘œ: < 1.0ì´ˆ)
- [ ] **Availability**: ê°€ìš©ì„± (ëª©í‘œ: > 99.9%)
- [ ] **Throughput**: ì²˜ë¦¬ëŸ‰ (ëª©í‘œ: > 1 RPS)

### Step 3.3: ìë™ ë°°í¬ í”„ë¡œì„¸ìŠ¤ ê´€ì°°
ìë™ ë°°í¬ê°€ ì§„í–‰ë˜ëŠ” ë™ì•ˆ ë‹¤ìŒì„ ê´€ì°°í•˜ì„¸ìš”:

1. **Stage 1 (5%)**: ì´ˆê¸° ì¹´ë‚˜ë¦¬ íŠ¸ë˜í”½
2. **Stage 2 (10%)**: ì ì§„ì  ì¦ê°€
3. **Stage 3 (25%)**: ë³¸ê²©ì ì¸ í…ŒìŠ¤íŠ¸
4. **Stage 4 (50%)**: ê³¼ë°˜ìˆ˜ íŠ¸ë˜í”½
5. **Stage 5 (100%)**: ì™„ì „ ì „í™˜

**â±ï¸ ê° ë‹¨ê³„ë³„ ëŒ€ê¸° ì‹œê°„:** 5ë¶„ (ì„¤ì • ê°€ëŠ¥)

---

## ğŸ“ˆ Phase 4: ë¶€í•˜ í…ŒìŠ¤íŠ¸ ë° SLO ê²€ì¦

### Step 4.1: K6 ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
```bash
# í–¥ìƒëœ ìë™ ë°°í¬ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
k6 run k6-tests/enhanced-auto-deployment-test.js

# ê¸°ë³¸ ì¹´ë‚˜ë¦¬ í…ŒìŠ¤íŠ¸ (ë³‘ë ¬ ì‹¤í–‰)
k6 run k6-tests/phase1-basic-canary.js
```

---

## ğŸš¨ Phase 5: ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤ ë° ìë™ ë¡¤ë°±

### Step 5.1: ì—ëŸ¬ ìƒí™© ì‹œë®¬ë ˆì´ì…˜
```bash
# ì—ëŸ¬ ì‹œë®¬ë ˆì´ì…˜ ì—”ë“œí¬ì¸íŠ¸ë¡œ íŠ¸ë˜í”½ ìƒì„±
for i in {1..100}; do
  curl -s http://localhost:8000/api/error-simulation
  sleep 0.5
done
```

### Step 5.2: ì•ŒëŒ ë° ë¡¤ë°± ê´€ì°°
```bash
# Alertmanager ìƒíƒœ í™•ì¸
curl http://localhost:9093/api/v2/alerts | jq .

# ìë™ ë¡¤ë°± ë¡œê·¸ í™•ì¸
docker-compose logs webhook-handler | grep -i rollback
```

**ğŸ”¥ ë¡¤ë°± íŠ¸ë¦¬ê±° ì¡°ê±´:**
- [ ] ì—ëŸ¬ìœ¨ > 5% (2ë¶„ ì§€ì†)
- [ ] ì‘ë‹µì‹œê°„ P95 > 1.5ì´ˆ (1ë¶„ ì§€ì†)
- [ ] ê°€ìš©ì„± < 99.9%

---

## ğŸ“Š Phase 6: ëª¨ë‹ˆí„°ë§ ë° ëŒ€ì‹œë³´ë“œ í™œìš©

### Step 6.1: Grafana ëŒ€ì‹œë³´ë“œ ì„¤ì •
1. http://localhost:3000 ì ‘ì† (admin/admin)
2. "Canary Deployment Logs" ëŒ€ì‹œë³´ë“œ ì—´ê¸°
3. ë‹¤ìŒ íŒ¨ë„ë“¤ í™•ì¸:
   - [ ] íŠ¸ë˜í”½ ë¶„ë°° í˜„í™©
   - [ ] ì—ëŸ¬ìœ¨ ë° ì‘ë‹µì‹œê°„
   - [ ] ë¹„ì¦ˆë‹ˆìŠ¤ ë©”íŠ¸ë¦­
   - [ ] ë°°í¬ ì§„í–‰ ìƒí™©

### Step 6.2: Prometheus ì¿¼ë¦¬ í•™ìŠµ
```promql
# ì—ëŸ¬ìœ¨ ê³„ì‚°
rate(nginx_http_requests_total{status=~"5.."}[2m]) / rate(nginx_http_requests_total[2m]) * 100

# ì‘ë‹µì‹œê°„ P95
histogram_quantile(0.95, rate(nginx_http_request_duration_seconds_bucket[2m]))

# ë²„ì „ë³„ íŠ¸ë˜í”½ ë¶„ë°°
sum by (upstream_addr) (rate(nginx_http_requests_total[1m]))

# ë¹„ì¦ˆë‹ˆìŠ¤ ì „í™˜ìœ¨
rate(business_orders_completed_total[5m]) / rate(business_orders_attempted_total[5m]) * 100
```

---

## ğŸ“ Phase 8: ê³ ê¸‰ ì‹œë‚˜ë¦¬ì˜¤ ë° ì‹¤ë¬´ ì ìš©

### Step 8.1: ë©€í‹° ì¹´ë‚˜ë¦¬ ì‹œë‚˜ë¦¬ì˜¤
```bash
# ì—¬ëŸ¬ ê¸°ëŠ¥ì„ ë™ì‹œì— í…ŒìŠ¤íŠ¸í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤
k6 run k6-tests/phase4-multi-canary.js
```

### Step 8.2: í”„ë¡œë•ì…˜ ê·œëª¨ í…ŒìŠ¤íŠ¸
```bash
# ëŒ€ìš©ëŸ‰ íŠ¸ë˜í”½ ì‹œë®¬ë ˆì´ì…˜
k6 run k6-tests/phase5-production-load.js
```

### Step 8.3: ë³µêµ¬ ë° ì¬ë°°í¬ ì‹œë‚˜ë¦¬ì˜¤
```bash
# ë¡¤ë°± í›„ ì¬ë°°í¬ í…ŒìŠ¤íŠ¸
curl -X POST http://localhost:8000/api/traffic/canary/rollback | jq .
sleep 30
curl -X POST http://localhost:8000/api/auto-deployment/start | jq .
```

---

## âœ… í•™ìŠµ ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ê¸°ë³¸ ì´í•´ë„
- [ ] ì¹´ë‚˜ë¦¬ ë°°í¬ì˜ ê°œë…ê³¼ ì¥ì  ì´í•´
- [ ] NGINX ë¡œë“œë°¸ëŸ°ì„œ ì„¤ì • ì´í•´
- [ ] Docker Compose ê¸°ë°˜ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ êµ¬ì¡° ì´í•´
- [ ] Prometheus/Grafana ëª¨ë‹ˆí„°ë§ ìŠ¤íƒ ì´í•´

### ì‹¤ë¬´ í™œìš© ëŠ¥ë ¥
- [ ] ìˆ˜ë™ íŠ¸ë˜í”½ ì œì–´ ë° ì¡°ì • ê°€ëŠ¥
- [ ] SLI/SLO ì •ì˜ ë° ì„ê³„ê°’ ì„¤ì • ê°€ëŠ¥
- [ ] ìë™ ë°°í¬ ì‹œìŠ¤í…œ êµ¬ì„± ë° ê´€ë¦¬ ê°€ëŠ¥
- [ ] ì¥ì•  ê°ì§€ ë° ìë™ ë¡¤ë°± ì‹œìŠ¤í…œ ì´í•´

### ê³ ê¸‰ ê¸°ëŠ¥
- [ ] ë¹„ì¦ˆë‹ˆìŠ¤ ë©”íŠ¸ë¦­ ê¸°ë°˜ ì˜ì‚¬ê²°ì • ê°€ëŠ¥
- [ ] A/B í…ŒìŠ¤íŠ¸ ì„¤ê³„ ë° ê²°ê³¼ ë¶„ì„ ê°€ëŠ¥
- [ ] ê¸°ëŠ¥ í”Œë˜ê·¸ ê¸°ë°˜ ì ì§„ì  ì¶œì‹œ ê°€ëŠ¥
- [ ] ë©€í‹° í™˜ê²½ ë°°í¬ ì „ëµ ìˆ˜ë¦½ ê°€ëŠ¥

### ëª¨ë‹ˆí„°ë§ ë° ë¶„ì„
- [ ] Grafana ëŒ€ì‹œë³´ë“œ ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ëŠ¥
- [ ] Prometheus ì¿¼ë¦¬ ì‘ì„± ê°€ëŠ¥
- [ ] ì•ŒëŒ ê·œì¹™ ì •ì˜ ë° ì›¹í›… ì„¤ì • ê°€ëŠ¥
- [ ] ì¥ì•  ë¶„ì„ ë° í¬ìŠ¤íŠ¸ëª¨í…œ ì‘ì„± ê°€ëŠ¥

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„ ì œì•ˆ

í•™ìŠµ ì™„ë£Œ í›„ ë‹¤ìŒ ë‹¨ê³„ë¡œ ë°œì „ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

1. **ë‹¤ì¤‘ í™˜ê²½ ì ìš©**: Dev/Stage/Prod í™˜ê²½ë³„ ì„¤ì •
2. **í´ë¼ìš°ë“œ ë°°í¬**: AWS/GCP/Azureì—ì„œ ì‹¤ì œ ìš´ì˜
3. **GitOps í†µí•©**: ArgoCD/Fluxì™€ ì—°ë™
4. **ì„œë¹„ìŠ¤ ë©”ì‹œ ì ìš©**: Istio/Linkerd ê¸°ë°˜ íŠ¸ë˜í”½ ê´€ë¦¬
5. **ê³ ê¸‰ ê´€ì°°ì„±**: Jaeger/Zipkin ë¶„ì‚° ì¶”ì  ì—°ë™

---

## ğŸ†˜ ë¬¸ì œ í•´ê²° ê°€ì´ë“œ

### ì¼ë°˜ì ì¸ ë¬¸ì œë“¤

**Q1: ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ë˜ì§€ ì•Šì•„ìš”**
```bash
# í¬íŠ¸ ì¶©ëŒ í™•ì¸
netstat -tulpn | grep :8000

# ë¡œê·¸ í™•ì¸
docker-compose logs [ì„œë¹„ìŠ¤ëª…]

# ì™„ì „ ì¬ì‹œì‘
docker-compose down -v && docker-compose up -d
```

**Q2: ë©”íŠ¸ë¦­ì´ ìˆ˜ì§‘ë˜ì§€ ì•Šì•„ìš”**
```bash
# Prometheus íƒ€ê²Ÿ ìƒíƒœ í™•ì¸
curl http://localhost:9090/api/v1/targets

# ì• í”Œë¦¬ì¼€ì´ì…˜ ë©”íŠ¸ë¦­ ì—”ë“œí¬ì¸íŠ¸ í™•ì¸
curl http://localhost:8080/actuator/metrics
```

**Q3: ìë™ ë°°í¬ê°€ ì‹œì‘ë˜ì§€ ì•Šì•„ìš”**
```bash
# í˜„ì¬ ë°°í¬ ìƒíƒœ í™•ì¸
curl http://localhost:8000/api/traffic/canary/status | jq .

# ìŠ¤ì¼€ì¤„ëŸ¬ ë¡œê·¸ í™•ì¸
docker-compose logs legacy-app-1 | grep AutoDeploymentScheduler
```

---

**ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤!** ì´ ê°€ì´ë“œë¥¼ ì™„ë£Œí•˜ì…¨ë‹¤ë©´ ì‹¤ë¬´ì—ì„œ ì¹´ë‚˜ë¦¬ ë°°í¬ ì‹œìŠ¤í…œì„ ì„¤ê³„í•˜ê³  ìš´ì˜í•  ìˆ˜ ìˆëŠ” ì—­ëŸ‰ì„ ê°–ì¶”ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

ì‹¤ì œ í”„ë¡œë•ì…˜ ì ìš© ì‹œì—ëŠ” ì¡°ì§ì˜ ìš”êµ¬ì‚¬í•­ì— ë§ê²Œ ì„ê³„ê°’ê³¼ ë°°í¬ ë‹¨ê³„ë¥¼ ì¡°ì •í•˜ì—¬ ì‚¬ìš©í•˜ì„¸ìš”.